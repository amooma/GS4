# Last Modified: Mon Jan  9 16:41:24 2012
#include <tunables/global>

/KNOPPIX/usr/sbin/kamailio {
  #include <abstractions/base>

  capability chown,
  capability dac_override,
  capability fowner,
  capability fsetid,
  capability kill,
  capability net_bind_service,
  capability net_raw,
  capability setgid,
  capability setuid,
  capability sys_ptrace,
  capability sys_resource,
  capability sys_tty_config,

  network inet,
  network inet6,


  /KNOPPIX/etc/group r,
  /KNOPPIX/etc/ld.so.cache r,
  /KNOPPIX/etc/nsswitch.conf r,
  /KNOPPIX/etc/odbc.ini r,
  /KNOPPIX/etc/odbcinst.ini r,
  /KNOPPIX/etc/passwd r,
  /KNOPPIX/lib/i386-linux-gnu/ld-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libc-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libdl-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libnsl-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libnss_compat-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libnss_files-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libnss_nis-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libpthread-*.so mr,
  /KNOPPIX/lib/i386-linux-gnu/libresolv-*.so mr,
  /KNOPPIX/opt/gemeinschaft/misc/kamailio/etc/* r,
  /KNOPPIX/usr/lib/i386-linux-gnu/gconv/ISO8859-*.so mr,
  /KNOPPIX/usr/lib/i386-linux-gnu/gconv/gconv-modules r,
  /KNOPPIX/usr/lib/i386-linux-gnu/gconv/gconv-modules.cache r,
  /KNOPPIX/usr/lib/kamailio/libkcore.so.* mr,
  /KNOPPIX/usr/lib/kamailio/libkmi.so.* mr,
  /KNOPPIX/usr/lib/kamailio/libsrdb1.so.* r,
  /KNOPPIX/usr/lib/kamailio/libsrdb1.so.1.0 m,
  /KNOPPIX/usr/lib/kamailio/modules/* mr,
  /KNOPPIX/usr/lib/kamailio/modules/auth.so mr,
  /KNOPPIX/usr/lib/kamailio/modules/avpops.so mr,
  /KNOPPIX/usr/lib/kamailio/modules/ctl.so mr,
  /KNOPPIX/usr/lib/kamailio/modules/mi_rpc.so mr,
  /KNOPPIX/usr/lib/kamailio/modules/sanity.so mr,
  /KNOPPIX/usr/lib/kamailio/modules/sl.so mr,
  /KNOPPIX/usr/lib/kamailio/modules/tm.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/acc.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/auth_db.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/db_unixodbc.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/kex.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/maxfwd.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/mi_fifo.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/pv.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/registrar.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/rr.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/siputils.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/textops.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/tmx.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/usrloc.so mr,
  /KNOPPIX/usr/lib/kamailio/modules_k/xlog.so mr,
  /KNOPPIX/usr/lib/lib*so* mr,
  /KNOPPIX/usr/lib/** mr,
  /KNOPPIX/usr/lib/odbc/libsqlite3odbc-*.so mr,
  /UNIONFS/etc/group r,
  /UNIONFS/etc/protocols r,
  /KNOPPIX/etc/protocols r,
  /UNIONFS/etc/ssl/** r,
  /KNOPPIX/etc/ssl/** r,
  /UNIONFS/etc/ld.so.cache r,
  /UNIONFS/etc/nsswitch.conf r,
  /UNIONFS/etc/odbc.ini rw,
  /UNIONFS/etc/odbcinst.ini r,
  /UNIONFS/etc/passwd r,
  /UNIONFS/etc/resolv.conf r,
  /UNIONFS/root/.odbc.ini rw,
  /UNIONFS/var/run/kamailio/* rw,
  /KNOPPIX/var/run/kamailio/* rw,
  /opt/gemeinschaft-local/db/production.* rwk,
  /ramdisk/etc/resolv.conf r,
  /opt/gemeinschaft-local/data/etc/resolv.conf r,
  /ramdisk/root/.odbc.ini ra,
  /tmp/* rw,

}
